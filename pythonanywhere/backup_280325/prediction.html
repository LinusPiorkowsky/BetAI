<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ML Bets - Predictions</title>
  <!-- Link to your CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>
<body>
  <!-- Navbar -->
  <nav>
    <div class="nav-left">Machine Learning Bets</div>
    <div class="nav-right">
      <a href="{{ url_for('index') }}">Home</a>
      <a href="{{ url_for('predictions') }}">Predictions</a>
      <a href="{{ url_for('results') }}">Results</a>
      <a href="{{ url_for('informations') }}">FAQ</a>
    </div>
  </nav>

  <!-- Page header -->
  <header>
    <h1>Upcoming Predictions</h1>
    <p>Prediction Updates: Tuesday and Friday</p>

    <!-- Filter section -->
    <div class="filters">
      <label for="league-select">League:</label>
      <select id="league-select">
        <option value="all">All</option>
        {% for league_code in leagues %}
          <option value="{{ league_code }}">
            {{ leagues_dict.get(league_code, league_code) }}
          </option>
        {% endfor %}
      </select>

      <label for="high-conf">
        <input type="checkbox" id="high-conf">
        High Confidence Predictions
      </label>

      <label for="odds-off">
        <input type="checkbox" id="odds-off">
        Odds
      </label>
    </div>
  </header>

  <!-- Cards container -->
  <div class="cards-container" id="predictions-container">
    {% if predictions %}
      {% for p in predictions %}
        {% set predicted_team = '' %}
        {% set predicted_prob = 0 %}
        {% set predicted_odd = 0 %}

        {% if p['Prediction'] == 'H' %}
          {% set predicted_team = p['HomeTeam'] %}
          {% set predicted_prob = p['Prob_H'] %}
          {% if p['B365H'] > 2.2 %}
            {% set predicted_odd = p['1X_odds'] %}
            {% set predicted_bet = p['HomeTeam'] + '/ Draw' %}
            {% set predicted_prob2 = p['1X_prob'] - 0.1 %}
          {% else %}
            {% set predicted_odd = p['B365H'] %}
            {% set predicted_bet = p['HomeTeam'] %}
            {% set predicted_prob2 = p['Prob_H'] %}
          {% endif %}
        {% elif p['Prediction'] == 'D' %}
          {% set predicted_team = 'Draw' %}
          {% set predicted_prob = p['Prob_D'] %}
          {% if p['B365H'] < p['B365A'] %}
            {% set predicted_bet = p['HomeTeam'] + '/ Draw'  %}
            {% set predicted_prob2 = p['1X_prob'] - 0.1 %}
            {% set predicted_odd = p['1X_odds'] %}
          {% else %}
            {% set predicted_bet = p['AwayTeam'] + '/ Draw'  %}
            {% set predicted_prob2 = p['X2_prob'] - 0.1 %}
            {% set predicted_odd = p['X2_odds'] %}
          {% endif %}
        {% elif p['Prediction'] == 'A' %}
          {% set predicted_team = p['AwayTeam'] %}
          {% set predicted_prob = p['Prob_A'] %}
          {% if p['B365A'] < 2.2 %}
            {% set predicted_bet = p['AwayTeam'] %}
            {% set predicted_prob2 = p['Prob_A'] %}
            {% set predicted_odd = p['B365A'] %}
          {% else %}
            {% set predicted_bet = p['AwayTeam'] + '/ Draw' %}
            {% set predicted_prob2 = p['X2_prob'] - 0.1 %}
            {% set predicted_odd = p['X2_odds']  %}
          {% endif %}
        {% endif %}

        <div
          class="prediction-card"
          data-league="{{ p['Div'] }}"
          data-highconf="{{ p['High_conf'] }}"
        >
          <!-- Top row: Date, Weekday, Time -->
          <div class="card-top">
            <span>{{ p['Weekday'] }} {{ p['Date'].strftime('%d.%m.%Y') }} {{ p['Time'][:5] }}</span>
        </div>
          <!-- Middle: HomeTeam vs. AwayTeam -->
          <div class="card-middle">
            <div class="matchup">
              <span>{{ p['HomeTeam'] }} vs. {{ p['AwayTeam'] }}</span>
            </div>
            <!-- Predicted Team + Probability -->
            <div class="prediction-info">
              Prediction: <span class="highlight">{{ predicted_bet }}</span>
              <br>
              Confidence: <span class="highlight"> {{ (predicted_prob2 * 100) | round(1) }}%</span>
            </div>
          </div>

          <!-- Odds Info (Hidden When "Odds Off" is Checked) -->
          <div class="odds-info">
            <br>
            <span>1X: {{ p['1X_odds'] }} | X2: {{ p['X2_odds'] }}</span>
            <br>
            <span>{{ p['HomeTeam'] }}: {{ p['B365H'] }} | Draw: {{ p['B365D'] }} | {{ p['AwayTeam'] }}: {{ p['B365A'] }}</span>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p style="text-align: center; width: 100%;">New Predictions Coming Soon</p>
    {% endif %}
  </div>

  <!-- JavaScript for Filtering -->
  <script>
    const leagueSelect = document.getElementById('league-select');
    const highConfCheckbox = document.getElementById('high-conf');
    const oddsOffCheckbox = document.getElementById('odds-off');
    const cards = document.querySelectorAll('.prediction-card');

    function filterPredictions() {
      const selectedLeague = leagueSelect.value;
      const highConfOnly = highConfCheckbox.checked;
      const oddsOff = !oddsOffCheckbox.checked;

      cards.forEach(card => {
        const cardLeague = card.getAttribute('data-league');
        const cardHighConf = card.getAttribute('data-highconf');

        let showCard = true;

        // Filter by league if not "all"
        if (selectedLeague !== 'all' && cardLeague !== selectedLeague) {
          showCard = false;
        }

        // Filter by high confidence if checked
        if (highConfOnly && cardHighConf !== '1') {
          showCard = false;
        }

        // Hide odds if "Odds Off" is checked
        const oddsElements = card.querySelectorAll('.odds-info');
        oddsElements.forEach(odds => {
          odds.style.display = oddsOff ? 'none' : 'block';
        });

        card.style.display = showCard ? 'block' : 'none';
      });
    }

    // Ensure high confidence checkbox is always checked
    highConfCheckbox.checked = true;
    oddsOffCheckbox.checked = true;

    leagueSelect.addEventListener('change', filterPredictions);
    highConfCheckbox.addEventListener('change', filterPredictions);
    oddsOffCheckbox.addEventListener('change', filterPredictions);

    // Initial filter on page load
    filterPredictions();
  </script>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <p>&copy; 2025 Machine Learning Bets</p>
      <p>This website is for educational purposes only</p>
      <p>No Prediction is guaranteed</p>
      <p>Contact: machinelearningbets@gmail.com</p>

      <!-- Social Media Links -->
      <div class="footer-links">
        <a href="https://x.com/Mlearningbets" target="_blank">
          <img src="{{ url_for('static', filename='icons/x.png') }}" alt="X" class="social-icon">
        </a>
        <a href="https://www.tiktok.com/@Machinelearningtipps" target="_blank">
          <img src="{{ url_for('static', filename='icons/tiktok.png') }}" alt="TikTok" class="social-icon">
        </a>
        <a href="https://www.instagram.com/machinelearningbets" target="_blank">
          <img src="{{ url_for('static', filename='icons/instagram.png') }}" alt="Instagram" class="social-icon">
        </a>
      </div>
    </div>
  </footer>

  <style>
    footer {
      background-color: #222;
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: 30px;
      width: auto;
    }
    .footer-links a {
      color: #ddd;
      text-decoration: none;
      margin: 0 10px;
    }
    .footer-links a:hover {
      color: #fff;
    }
    .social-icon {
    width: 30px;  /* Adjust icon size */
    height: auto;
    transition: transform 0.2s ease-in-out;
    }
    .social-icon:hover {
    transform: scale(1.2); /* Slight zoom effect on hover */
    }
  </style>
</body>
</html>

